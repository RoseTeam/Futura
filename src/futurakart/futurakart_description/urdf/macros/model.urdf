<?xml version="1.0" ?>
<!--
     Futurakart model description
 -->
<robot name="xacro_properties" xmlns:xacro="http://ros.org/wiki/xacro">

    <!-- Include common properties -->
    <xacro:include filename="$(find futurakart_description)/urdf/macros/common.urdf" />
    <!-- Include dimensions -->
    <xacro:include filename="$(find futurakart_description)/urdf/macros/dimensions.urdf" />

    <!--**************************************************************************-->
    <!-- Macros to define front wheels  -->
    <!--**************************************************************************-->

    <!--Joint types : http://wiki.ros.org/urdf/XML/joint -->
    <xacro:macro name="front_wheel" params="prefix **arm_pose **wheel_pose">

        <!--        Wheel link-->
        <link name="front_${prefix}_wheel_link">
            <visual>
                <origin xyz="0 0 0" rpy="${PI/2} 0 0"/>
                <geometry>
                    <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
                </geometry>
                <material name="black" />
            </visual>
            <collision>
                <origin xyz="0 0 0" rpy="${PI/2} 0 0"/>
                <geometry>
                    <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="${PI/2} 0 0"/>
                <mass value="1.0"/>
                <inertia
                        ixx="0.00450833" ixy="0" ixz="0"
                        iyy="0.00130208" iyz="0"
                        izz="0.004508333"/>
            </inertial>
        </link>
        <gazebo reference="front_${prefix}_wheel_link">
            <material>Gazebo/DarkGrey</material>
        </gazebo>

        <!--        Steering arm link-->
        <link name="front_${prefix}_steering_arm_link">
            <visual>
                <origin xyz="0 ${track_arm/2} 0" rpy="${PI/2} 0 0"/>
                <geometry>
                    <cylinder radius="0.005" length="${track_arm}"/>
                </geometry>
                <material name="black" />
            </visual>
            <collision>
                <origin xyz="0 ${track_arm/2} 0" rpy="${PI/2} 0 0"/>
                <geometry>
                    <cylinder radius="0.005" length="${track_arm}"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 ${track_arm/2} 0" rpy="${PI/2} 0 0"/>
                <mass value="0.1"/>
                <inertia
                        ixx="0.00012" ixy="0" ixz="0"
                        iyy="0.0000002" iyz="0"
                        izz="0.00012"/>
            </inertial>
        </link>

        <gazebo reference="front_${prefix}_steering_arm_link">
            <material>Gazebo/DarkGrey</material>
        </gazebo>


        <!--        Joint from base_link to steering arm-->
        <joint name="front_${prefix}_steering_arm" type="revolute">
            <parent link="base_link"/>
            <child link="front_${prefix}_steering_arm_link" />
            <!--http://wiki.ros.org/pr2_controller_manager/safety_limits-->
            <limit lower="-0.5" upper="0.5" effort="10" velocity="1.0"/>
            <axis xyz="0 0 1" />
            <xacro:insert_block name="arm_pose"/>

        </joint>

        <!--        Joint from steering arm to wheel-->
        <joint name="${prefix}_front_wheel" type="continuous">
            <parent link="front_${prefix}_steering_arm_link"/>
            <child link="front_${prefix}_wheel_link" />
            <xacro:insert_block name="wheel_pose"/>
        </joint>

        <!--For Gazebo only-->
        <transmission name="front_${prefix}_steering_arm_trans">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="front_${prefix}_steering_arm">
                <hardwareInterface>PositionJointInterface</hardwareInterface>
            </joint>
            <actuator name="front_${prefix}_steering_arm_actuator">
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>
        <transmission name="front_${prefix}_wheel_trans">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="front_${prefix}_wheel">
                <hardwareInterface>VelocityJointInterface</hardwareInterface>
            </joint>
            <actuator name="front_${prefix}_wheel_actuator">
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>

    </xacro:macro>


    <!--**************************************************************************-->
    <!-- Macros to define rear wheels  -->
    <!--**************************************************************************-->
    <xacro:macro name="rear_wheel" params="prefix parent_link *joint_pose">

        <link name="rear_${prefix}_wheel_link">
            <visual>
                <origin xyz="0 0 0" rpy="${PI/2} 0 0"/>
                <geometry>
                    <!--mesh filename="package://futurakart_description/meshes/futurakart-wheel.stl"/-->
                    <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
                </geometry>
                <material name="black" />
            </visual>
            <collision>
                <origin xyz="0 0 0" rpy="${PI/2} 0 0"/>
                <geometry>
                    <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
                </geometry>
            </collision>
            <inertial>
                <origin xyz="0 0 0" rpy="${PI/2} 0 0"/>
                <mass value="1.0"/>
                <inertia
                        ixx="0.00450833" ixy="0" ixz="0"
                        iyy="0.00130208" iyz="0"
                        izz="0.004508333"/>
            </inertial>
        </link>

        <gazebo reference="rear_${prefix}_wheel_link">
            <material>Gazebo/DarkGrey</material>
        </gazebo>

        <joint name="rear_${prefix}_wheel" type="continuous">
            <parent link="${parent_link}"/>
            <child link="rear_${prefix}_wheel_link" />
            <xacro:insert_block name="joint_pose" />
            <axis xyz="0 1 0" />
        </joint>

        <!--For Gazebo only-->
        <transmission name="rear_${prefix}_wheel_trans">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="rear_${prefix}_wheel">
                <hardwareInterface>VelocityJointInterface</hardwareInterface>
            </joint>
            <actuator name="rear_${prefix}_actuator">
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>


    </xacro:macro>




</robot>
